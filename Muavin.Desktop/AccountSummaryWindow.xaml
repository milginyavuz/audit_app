<!-- Muavin.Desktop/AccountSummaryWindow.xaml -->
<Window x:Class="Muavin.Desktop.AccountSummaryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Hesap Özeti" Width="1120" Height="620"
        WindowStartupLocation="CenterOwner">
    <DockPanel>

        <!-- ÜST FİLTRE BAR -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="8">
            <TextBlock Text="Kebir:" Margin="0,0,6,0" VerticalAlignment="Center"/>
            <TextBox x:Name="tbKBas" Width="70" HorizontalContentAlignment="Center"/>
            <TextBlock Text="–" Margin="4,0" VerticalAlignment="Center"/>
            <TextBox x:Name="tbKBit" Width="70" HorizontalContentAlignment="Center"/>

            <Separator Margin="12,0"/>

            <TextBlock Text="Tarih:" Margin="0,0,6,0" VerticalAlignment="Center"/>
            <DatePicker x:Name="dpBas" Width="140"/>
            <TextBlock Text="–" Margin="4,0" VerticalAlignment="Center"/>
            <DatePicker x:Name="dpBit" Width="140"/>

            <Separator Margin="12,0"/>

            <TextBlock Text="Hesap Kodu:" Margin="0,0,6,0" VerticalAlignment="Center"/>
            <TextBox x:Name="tbHesap" Width="220" ToolTip="Virgülle çoklu hesap kodu"/>

            <Button Content="Özetle" Margin="12,0,0,0" Padding="14,6" Click="Summarize_Click"/>
            <Button Content="Excel’e Aktar" Margin="6,0,0,0" Padding="14,6" Click="Export_Click"/>
        </StackPanel>

        <!-- HESAP ÖZET TABLOSU -->
        <DataGrid x:Name="grid"
                  Margin="8"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserAddRows="False"
                  ItemsSource="{Binding}">
            <DataGrid.Resources>
                <Style x:Key="RightAlign" TargetType="TextBlock">
                    <Setter Property="TextAlignment" Value="Right"/>
                </Style>
            </DataGrid.Resources>

            <DataGrid.Columns>
                <DataGridTextColumn Header="Hesap Kodu"
                                    Binding="{Binding HesapKodu}"
                                    Width="180"/>

                <DataGridTextColumn Header="Hesap Adı"
                                    Binding="{Binding HesapAdi}"
                                    Width="*"/>

                <!-- ✅ Yeni: Son Tarih -->
                <DataGridTextColumn Header="Son Tarih"
                                    Binding="{Binding LastDate, StringFormat={}{0:dd.MM.yyyy}}"
                                    Width="120"/>

                <DataGridTextColumn Header="Toplam Borç"
                                    Binding="{Binding Borc, StringFormat={}{0:N2}}"
                                    Width="150"
                                    ElementStyle="{StaticResource RightAlign}"/>

                <DataGridTextColumn Header="Toplam Alacak"
                                    Binding="{Binding Alacak, StringFormat={}{0:N2}}"
                                    Width="150"
                                    ElementStyle="{StaticResource RightAlign}"/>

                <!-- ✅ Yeni: Son Bakiye (RunningBalance) -->
                <DataGridTextColumn Header="Son Bakiye"
                                    Binding="{Binding LastRunningBalance, StringFormat={}{0:N2}}"
                                    Width="160"
                                    ElementStyle="{StaticResource RightAlign}"/>

                <!-- Eski kolon kalsın istiyorsan kalsın: -->
                <DataGridTextColumn Header="Toplam Bakiye"
                                    Binding="{Binding Bakiye, StringFormat={}{0:N2}}"
                                    Width="150"
                                    ElementStyle="{StaticResource RightAlign}"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
