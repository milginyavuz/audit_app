<Window x:Class="Muavin.Desktop.AgingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Muavin.Desktop.ViewModels"
        xmlns:attached="clr-namespace:Muavin.Desktop.Attached"

        mc:Ignorable="d"
        Title="Cari Hesap Yaşlandırma" Width="1200" Height="720"
        WindowStartupLocation="CenterOwner">
    <DockPanel>

        <!-- Üst bar -->
        <Border DockPanel.Dock="Top" Padding="8" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" attached:StackPanelSpacing.Spacing="8">
                <TextBlock Text="Yaşlandırma Tarihi:" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding AgingDate}"/>

                <TextBlock Text="Kebir (virgül):" Margin="16,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="320" Text="{Binding KebirFilter}"/>

                <CheckBox Content="Sıfır bakiyeleri gösterme" Margin="16,0,0,0"
                          IsChecked="{Binding OnlyNonZero}"/>

                <Button Content="Yaşlandır" Padding="14,6" Margin="16,0,0,0"
                        Command="{Binding RebuildCommand}"/>
            </StackPanel>
        </Border>

        <!-- Özet -->
        <ScrollViewer DockPanel.Dock="Top" HorizontalScrollBarVisibility="Auto">
            <UniformGrid Columns="14" Margin="8" >
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="0–30" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T0_30, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="30–60" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T30_60, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="60–90" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T60_90, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="90–120" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T90_120, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="120–150" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T120_150, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="150–180" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T150_180, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="180–210" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T180_210, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="210–240" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T210_240, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="240–270" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T240_270, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="270–300" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T270_300, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="300–330" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T300_330, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="330–365" FontWeight="Bold"/>
                        <TextBlock Text="{Binding T330_365, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#ddd" BorderThickness="1" Background="#f7f7f7">
                    <StackPanel>
                        <TextBlock Text=">365" FontWeight="Bold"/>
                        <TextBlock Text="{Binding TGt365, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
                <Border Padding="6" BorderBrush="#bbb" BorderThickness="1" Background="#eef6ff">
                    <StackPanel>
                        <TextBlock Text="BAKİYE" FontWeight="Bold"/>
                        <TextBlock Text="{Binding TBakiye, StringFormat=N2}" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Border>
            </UniformGrid>
        </ScrollViewer>

        <!-- Grid -->
        <DataGrid ItemsSource="{Binding Rows}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  EnableRowVirtualization="True"
                  Margin="8"
                  ColumnHeaderHeight="30">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Hesap Kodu" Binding="{Binding HesapKodu}" Width="160"/>
                <DataGridTextColumn Header="Hesap Adı"   Binding="{Binding HesapAdi}"  Width="260"/>

                <DataGridTextColumn Header="0-30"   Binding="{Binding B0_30,     StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="30-60"  Binding="{Binding B30_60,    StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="60-90"  Binding="{Binding B60_90,    StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="90-120" Binding="{Binding B90_120,   StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="120-150" Binding="{Binding B120_150, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="150-180" Binding="{Binding B150_180, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="180-210" Binding="{Binding B180_210, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="210-240" Binding="{Binding B210_240, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="240-270" Binding="{Binding B240_270, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="270-300" Binding="{Binding B270_300, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="300-330" Binding="{Binding B300_330, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header="330-365" Binding="{Binding B330_365, StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>
                <DataGridTextColumn Header=">365"    Binding="{Binding BGt365,   StringFormat=N2}" Width="110" ElementStyle="{StaticResource RightCell}"/>

                <DataGridTextColumn Header="Bakiye"  Binding="{Binding Bakiye,   StringFormat=N2}" Width="130" ElementStyle="{StaticResource RightCell}"/>
            </DataGrid.Columns>

            <DataGrid.Resources>
                <Style x:Key="RightCell" TargetType="TextBlock">
                    <Setter Property="HorizontalAlignment" Value="Right"/>
                </Style>
            </DataGrid.Resources>
        </DataGrid>

        <!-- alt durum -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem Content="{Binding Rows.Count, StringFormat=Toplam Hesap: {0}}"/>
        </StatusBar>
    </DockPanel>
</Window>
